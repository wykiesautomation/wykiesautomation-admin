<!doctype html>
<html lang="en" class="h-full">
<head>
  <meta charset="utf-8" />
  <title>Wykies Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --brand-blue:#2F76FF; }
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
  </style>
</head>
<body class="h-full bg-slate-950 text-slate-100">
  <div class="flex h-full">
    <aside class="w-64 bg-slate-900 border-r border-slate-800 p-4">
      <div class="flex items-center gap-3">
        <img src="/assets/logo-blue.png" class="h-8" alt="logo"><span class="font-semibold">Admin</span>
      </div>
      <nav class="mt-6 space-y-1 text-sm">
        <a class="block px-3 py-2 rounded hover:bg-slate-800" href="#dashboard">Dashboard</a>
        <a class="block px-3 py-2 rounded hover:bg-slate-800" href="#catalog">Catalog</a>
        <a class="block px-3 py-2 rounded hover:bg-slate-800" href="#prices">Price Log</a>
        <a class="block px-3 py-2 rounded hover:bg-slate-800" href="#payments">Payments</a>
        <a class="block px-3 py-2 rounded hover:bg-slate-800" href="#pages">Pages</a>
        <a class="block px-3 py-2 rounded hover:bg-slate-800" href="#settings">Settings</a>
        <a class="block px-3 py-2 rounded hover:bg-slate-800" href="#audit">Audit</a>
      </nav>
      <div class="mt-6">
        <button id="signin" class="w-full px-3 py-2 rounded bg-blue-600 hover:bg-blue-700">Sign in with Google</button>
        <p class="text-xs text-slate-400 mt-2">Allowlist: wykiesautomation@gmail.com</p>
      </div>
    </aside>

    <main class="flex-1 p-6 overflow-y-auto space-y-10">
      <section id="dashboard">
        <h1 class="text-xl font-bold">Dashboard</h1>
        <div class="grid md:grid-cols-3 gap-4 mt-4">
          <div class="bg-slate-900 border border-slate-800 p-4 rounded"><div class="text-slate-400 text-sm">Today’s Sales</div><div class="text-2xl font-semibold">R 0</div></div>
          <div class="bg-slate-900 border border-slate-800 p-4 rounded"><div class="text-slate-400 text-sm">Verified ITNs (24h)</div><div class="text-2xl font-semibold">0</div></div>
          <div class="bg-slate-900 border border-slate-800 p-4 rounded"><div class="text-slate-400 text-sm">Queue Health</div><div class="text-2xl font-semibold">OK</div></div>
        </div>
      </section>

      <section id="catalog">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold">Catalog</h2>
          <button class="px-3 py-2 rounded bg-blue-600 hover:bg-blue-700">Add Product</button>
        </div>
        <div class="mt-4 overflow-x-auto">
          <table class="min-w-full text-sm">
            <thead class="text-slate-400"><tr><th class="text-left p-2">ID</th><th class="text-left p-2">Name</th><th class="text-left p-2">Price (incl VAT)</th><th class="text-left p-2">Images</th><th class="text-left p-2">Status</th><th class="text-left p-2"></th></tr></thead>
            <tbody id="admin-catalog"></tbody>
          </table>
        </div>
      </section>

      <section id="prices">
        <h2 class="text-lg font-semibold">Price Log</h2>
        <div class="mt-3 bg-slate-900 border border-slate-800 rounded">
          <div class="p-3 text-xs text-slate-400">Append-only: product_id, old, new, who, when, note</div>
          <div id="price-log" class="max-h-56 overflow-y-auto divide-y divide-slate-800"></div>
        </div>
      </section>

      <section id="payments">
        <h2 class="text-lg font-semibold">Payments</h2>
        <div class="mt-3 overflow-x-auto">
          <table class="min-w-full text-sm">
            <thead class="text-slate-400"><tr><th class="text-left p-2">Date</th><th class="text-left p-2">Order</th><th class="text-left p-2">Email</th><th class="text-left p-2">Total</th><th class="text-left p-2">Status</th><th class="text-left p-2"></th></tr></thead>
            <tbody id="payments-body"></tbody>
          </table>
        </div>
      </section>

      <section id="pages">
        <h2 class="text-lg font-semibold">Pages (Markdown)</h2>
        <div class="mt-3 grid lg:grid-cols-2 gap-4">
          <div class="bg-slate-900 border border-slate-800 p-3 rounded">
            <label class="text-sm text-slate-400">Slug</label>
            <input id="page-slug" class="w-full mt-1 px-2 py-1 rounded bg-slate-950 border border-slate-800" value="privacy" />
            <label class="text-sm text-slate-400 mt-3 block">Title</label>
            <input id="page-title" class="w-full mt-1 px-2 py-1 rounded bg-slate-950 border border-slate-800" value="Privacy Policy (POPIA)" />
            <label class="text-sm text-slate-400 mt-3 block">Content (Markdown)</label>
            <textarea id="page-content" rows="10" class="w-full mt-1 px-2 py-2 rounded bg-slate-950 border border-slate-800">## Privacy (POPIA)\nWe collect contact and order details to process sales via PayFast…</textarea>
            <div class="mt-3 flex justify-end">
              <button class="px-3 py-2 rounded bg-blue-600 hover:bg-blue-700">Save</button>
            </div>
          </div>
          <div class="bg-slate-900 border border-slate-800 p-3 rounded">
            <div class="text-sm text-slate-400 mb-2">Preview</div>
            <div class="prose prose-invert max-w-none" id="page-preview">
              <h2>Privacy (POPIA)</h2>
              <p>We collect contact and order details to process sales via PayFast…</p>
            </div>
          </div>
        </div>
      </section>

      <section id="settings">
        <h2 class="text-lg font-semibold">Settings</h2>
        <div class="mt-3 grid md:grid-cols-2 gap-4">
          <div class="bg-slate-900 border border-slate-800 p-3 rounded">
            <label class="text-sm text-slate-400">Company Name</label>
            <input class="w-full mt-1 px-2 py-1 rounded bg-slate-950 border border-slate-800" value="Wykies Automation" />
            <label class="text-sm text-slate-400 mt-3 block">VAT Number</label>
            <input class="w-full mt-1 px-2 py-1 rounded bg-slate-950 border border-slate-800" placeholder="ZAxxxxxxxxx" />
            <label class="text-sm text-slate-400 mt-3 block">Registered Address</label>
            <textarea rows="3" class="w-full mt-1 px-2 py-1 rounded bg-slate-950 border border-slate-800"></textarea>
            <label class="text-sm text-slate-400 mt-3 block">Support Email</label>
            <input class="w-full mt-1 px-2 py-1 rounded bg-slate-950 border border-slate-800" value="wykiesautomation@gmail.com" />
          </div>
          <div class="bg-slate-900 border border-slate-800 p-3 rounded">
            <label class="text-sm text-slate-400">Logo</label>
            <input type="file" class="block mt-1 text-sm" />
            <label class="text-sm text-slate-400 mt-3 block">Brand Color</label>
            <input type="color" value="#2F76FF" class="mt-1 h-10 w-20 rounded bg-slate-950 border border-slate-800" />
            <div class="mt-4"><button class="px-3 py-2 rounded bg-blue-600 hover:bg-blue-700">Save Settings</button></div>
          </div>
        </div>
      </section>

      <section id="audit">
        <h2 class="text-lg font-semibold">Audit Log</h2>
        <div id="audit-log" class="mt-3 bg-slate-900 border border-slate-800 rounded max-h-60 overflow-y-auto"></div>
      </section>
    </main>
  </div>

  <script>
    // Demo: hydrate admin catalog from public/products.json
    fetch('/products.json').then(r=>r.json()).then(list => {
      const body = document.getElementById('admin-catalog');
      list.forEach(p=>{
        const tr = document.createElement('tr');
        tr.className = 'border-t border-slate-800';
        tr.innerHTML = `<td class='p-2'>${p.id}</td><td class='p-2'>${p.name}</td><td class='p-2'>R${p.price_vat_incl}</td><td class='p-2'><button class='px-2 py-1 rounded bg-slate-800 hover:bg-slate-700'>Manage</button></td><td class='p-2'>${p.status.replace('_',' ')}</td><td class='p-2 text-right'><button class='px-2 py-1 rounded bg-slate-800 hover:bg-slate-700'>Edit</button></td>`;
        body.appendChild(tr);
      });
    });
    // Demo logs
    document.getElementById('price-log').innerHTML = `<div class='p-3 text-sm'><span class='text-slate-400'>2025-12-31 09:10</span> — WA‑01: R1,399 → <span class='text-green-400 font-medium'>R1,499</span> (Janes)</div>`;
    document.getElementById('audit-log').innerHTML = `<div class='p-3 text-sm'>2025‑12‑31 09:12 — price.update WA‑01 (user: wykiesautomation@gmail.com)</div>`;
  </script>
</body>
</html>