
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Wykies Automation — Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css?v=20251226-1" />
</head>
<body>
  <!-- Header -->
  <header class="nav">
    <div class="title">Admin</div>
    <nav>
      <a href="#login" id="tab-login">Login</a>
      <a href="#products" id="tab-products">Products</a>
      <a href="#gallery" id="tab-gallery">Gallery</a>
      <a href="#dashboard" id="tab-dashboard">Dashboard</a>
    </nav>
  </header>

  <!-- Toast -->
  <div id="toast" class="toast hidden"></div>

  <!-- Content -->
  <main class="container">
    <!-- Login -->
    <section id="panel-login" class="card">
      <h2 style="margin-top:0">Login</h2>
      <div class="row">
        <div style="flex:1">
          <label>Email</label>
          <input id="login-email" type="email" placeholder="admin@wykiesautomation.co.za" autocomplete="username" />
        </div>
        <div style="flex:1">
          <label>Password</label>
          <input id="login-password" type="password" placeholder="••••••••" autocomplete="current-password" />
        </div>
      </div>
      <div class="row" style="margin-top:.75rem">
        <button id="btn-login">Sign in</button>
        <span id="login-status" class="badge hidden"></span>
      </div>
      <p class="muted" style="margin-top:.75rem">
        This demo stores a temporary token in <span class="mono">localStorage</span>. Replace with your Apps Script / Flask JWT endpoint when ready.
      </p>
    </section>

    <!-- Products -->
    <section id="panel-products" class="card hidden">
      <h2 style="margin-top:0">Products</h2>
      <div class="row" style="flex-wrap:wrap">
        <div class="card" style="flex:1;min-width:320px">
          <label>ID</label>
          <input id="prod-id" placeholder="WA-01" />
          <label>Name</label>
          <input id="prod-name" placeholder="Hybrid Gate Controller" />
          <label>Price (ZAR)</label>
          <input id="prod-price" type="number" placeholder="1499" />
          <label>Description</label>
          <textarea id="prod-desc" placeholder="Short description..."></textarea>
          <div style="margin-top:.75rem">
            <button id="btn-save-product">Save product</button>
          </div>
        </div>

        <div class="card" style="flex:1;min-width:320px">
          <h3 style="margin-top:0">Existing products</h3>
          <div id="product-list" class="list"></div>
          <div style="margin-top:.75rem">
            <button class="secondary" id="btn-refresh-products">Refresh</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Gallery -->
    <section id="panel-gallery" class="card hidden">
      <h2 style="margin-top:0">Gallery</h2>
      <div class="row" style="flex-wrap:wrap">
        <div class="card" style="flex:1;min-width:320px">
          <label>Image URL</label>
          <input id="gal-url" placeholder="https://..." />
          <label>ALT text</label>
          <input id="gal-alt" placeholder="Product photo – Hybrid Gate Controller" />
          <div style="margin-top:.75rem">
            <button id="btn-add-image">Add image</button>
          </div>
        </div>

        <div class="card" style="flex:1;min-width:320px">
          <h3 style="margin-top:0">Images</h3>
          <div id="gallery-list" class="list"></div>
        </div>

        <div class="card" style="flex:1;min-width:320px">
          <h3 style="margin-top:0">Preview</h3>
          <img id="gal-preview" src="" alt="" style="max-width:100%;border-radius:10px;border:1px solid var(--border)" />
        </div>
      </div>
    </section>

    <!-- Dashboard -->
    <section id="panel-dashboard" class="card hidden">
      <h2 style="margin-top:0">Dashboard</h2>
      <div class="row" style="flex-wrap:wrap">
        <div class="card" style="flex:1;min-width:320px">
          <h3 style="margin-top:0">Summary</h3>
          <div class="list">
            <div class="list-item"><div>Total products</div><div id="metric-products" class="badge">0</div></div>
            <div class="list-item"><div>Total gallery images</div><div id="metric-images" class="badge">0</div></div>
          </div>
        </div>
        <div class="card" style="flex:1;min-width:320px">
          <h3 style="margin-top:0">Recent activity</h3>
          <div id="activity" class="list"></div>
        </div>
        <div class="card" style="flex:1;min-width:320px">
          <h3 style="margin-top:0">Session</h3>
          <div class="list-item"><div>Logged in</div><div id="metric-auth" class="badge">No</div></div>
          <div style="margin-top:.75rem"><button class="secondary" id="btn-logout">Sign out</button></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Default tab -->
  <script>
    if (!location.hash) location.hash = '#login';
  </script>

  <!-- Tab logic -->
  <script>
    const panels = {
      login: document.getElementById('panel-login'),
      products: document.getElementById('panel-products'),
      gallery: document.getElementById('panel-gallery'),
      dashboard: document.getElementById('panel-dashboard')
    };
    const tabs = {
      login: document.getElementById('tab-login'),
      products: document.getElementById('tab-products'),
      gallery: document.getElementById('tab-gallery'),
      dashboard: document.getElementById('tab-dashboard')
    };
    function show(el){ el.classList.remove('hidden'); }
    function hide(el){ el.classList.add('hidden'); }
    function setActiveTab(name){
      Object.values(panels).forEach(hide);
      if (panels[name]) show(panels[name]);
      Object.values(tabs).forEach(a => a.classList.remove('active'));
      if (tabs[name]) tabs[name].classList.add('active');
    }
    function navigate(){
      const hash = (location.hash || '#login').replace('#','');
      setActiveTab(hash);
    }
    window.addEventListener('hashchange', navigate);
    navigate();
  </script>

  <!-- Demo-only logic (login, lists) -->
  <script>
    const $ = s => document.querySelector(s);
    function toast(msg){ const t=$('#toast'); t.textContent=msg; t.classList.remove('hidden'); clearTimeout(t._h); t._h=setTimeout(()=>t.classList.add('hidden'),3000); }

    document.getElementById('btn-login')?.addEventListener('click', ()=>{
      localStorage.setItem('wykies.token', 'demo-'+Math.random().toString(36).slice(2));
      document.getElementById('metric-auth').textContent='Yes';
      const st=document.getElementById('login-status'); st.textContent='Signed in'; st.classList.remove('hidden');
      location.hash='#dashboard'; toast('Signed in');
    });
    document.getElementById('btn-logout')?.addEventListener('click', ()=>{
      localStorage.removeItem('wykies.token');
      document.getElementById('metric-auth').textContent='No';
      location.hash='#login'; toast('Signed out');
    });

    const defaultProducts=[
      { id:'WA-01', name:'Hybrid Gate Controller (GSM)', price:1499 },
      { id:'WA-02', name:'Hybrid Gate Controller (ESP32)', price:2499 }
    ];
    function renderProducts(){
      const host=document.getElementById('product-list'); if(!host) return; host.innerHTML='';
      defaultProducts.forEach(p=>{
        const row=document.createElement('div'); row.className='list-item';
        row.innerHTML=`<div><strong>${p.id}</strong> — ${p.name}<div class='muted'>R ${Number(p.price).toFixed(2)}</div></div><div class='row'><button class='secondary'>Delete</button></div>`;
        host.appendChild(row);
      });
      document.getElementById('metric-products').textContent=String(defaultProducts.length);
    }
    renderProducts();
  </script>
</body>
</html>
