<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Wykies Admin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@11.2.0/lib/marked.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
</head>
<body>
  <header class="header">
    <div class="logo"><img src="assets/logo.svg" alt="Wykies Automation"><span>Admin</span></div>
    <nav id="nav">
      <a href="#dashboard" data-tab="dashboard">Dashboard</a>
      <a href="#catalog" data-tab="catalog">Catalog</a>
      <a href="#prices" data-tab="prices">Price Log</a>
      <a href="#payments" data-tab="payments">Payments</a>
      <a href="#pages" data-tab="pages">Pages</a>
      <a href="#settings" data-tab="settings">Settings</a>
      <a href="#audit" data-tab="audit">Audit</a>
    </nav>
    <div class="actions">
      <div id="signin" class="hidden">
        <div id="g_id_onload" data-client_id="REPLACE_WITH_OAUTH_CLIENT_ID" data-auto_prompt="false"></div>
        <div class="btn" id="googleBtn">Sign in with Google</div>
      </div>
      <div id="userBox" class="hidden">
        <span id="userEmail" class="badge"></span>
        <button class="btn secondary" id="signOut">Sign out</button>
      </div>
    </div>
  </header>
  <main class="container">
    <section id="tab-dashboard" class="card">
      <h2>Dashboard</h2>
      <div class="grid">
        <div class="tile card"><div class="section-title"><span>Today’s Sales</span><span class="badge">ZAR</span></div><div class="value" id="salesToday">R 0</div></div>
        <div class="tile card"><div class="section-title"><span>Verified ITNs (24h)</span></div><div class="value" id="itnCount">0</div></div>
        <div class="tile card"><div class="section-title"><span>Queue Health</span></div><div class="value" id="queueHealth">OK</div></div>
      </div>
    </section>
    <section id="tab-catalog" class="card hidden">
      <div class="section-title"><h2>Catalog</h2><button class="btn" id="btnAddProduct">Add Product</button></div>
      <table class="table" id="catalogTable"><thead><tr><th>ID</th><th>Name</th><th>Price (incl VAT)</th><th>Images</th><th>Status</th><th></th></tr></thead><tbody></tbody></table>
    </section>
    <section id="tab-prices" class="card hidden">
      <h2>Price Log</h2>
      <p class="muted">Append-only: product_id, old, new, who, when, note</p>
      <table class="table" id="priceLogTable"><thead><tr><th>Product</th><th>Old</th><th>New</th><th>Who</th><th>When</th><th>Note</th></tr></thead><tbody></tbody></table>
    </section>
    <section id="tab-payments" class="card hidden">
      <div class="section-title"><h2>Payments</h2><span class="badge" id="pfMode">PayFast LIVE</span></div>
      <table class="table" id="paymentsTable"><thead><tr><th>Date</th><th>Order</th><th>Email</th><th>Total</th><th>Status</th><th></th></tr></thead><tbody></tbody></table>
    </section>
    <section id="tab-pages" class="card hidden">
      <div class="section-title"><h2>Pages (Markdown)</h2><button class="btn" id="btnSavePage">Save</button></div>
      <div class="grid">
        <div class="card" style="grid-column: span 6">
          <label>Slug</label>
          <input class="input" id="pageSlug" placeholder="privacy"/>
          <label>Title</label>
          <input class="input" id="pageTitle" placeholder="Privacy (POPIA)"/>
          <label>Content (Markdown)</label>
          <textarea id="pageContent" rows="12" class="input">## Privacy (POPIA)
We collect contact and order details to process sales via PayFast…</textarea>
        </div>
        <div class="card" style="grid-column: span 6">
          <div class="section-title"><span>Preview</span><button class="btn secondary" id="btnPreview">Refresh</button></div>
          <div id="pagePreview" class="markdown"></div>
        </div>
      </div>
    </section>
    <section id="tab-settings" class="card hidden">
      <div class="section-title"><h2>Settings</h2><button class="btn" id="btnSaveSettings">Save Settings</button></div>
      <div class="grid">
        <div class="card" style="grid-column: span 6">
          <label>Company Name</label><input id="companyName" class="input"/>
          <label>VAT Number</label><input id="vatNumber" class="input"/>
          <label>Registered Address</label><textarea id="registeredAddress" rows="4" class="input"></textarea>
          <label>Support Email</label><input id="supportEmail" class="input"/>
        </div>
        <div class="card" style="grid-column: span 6">
          <label>Logo</label><input type="file" id="logoUpload" accept="image/*"/>
          <label>Brand Color</label><input id="brandColor" class="input" value="#2F76FF"/>
        </div>
      </div>
    </section>
    <section id="tab-audit" class="card hidden">
      <h2>Audit Log</h2>
      <table class="table" id="auditTable"><thead><tr><th>When</th><th>Who</th><th>Event</th><th>Detail</th></tr></thead><tbody></tbody></table>
    </section>
    <section id="accessDenied" class="card hidden">
      <h2>Access denied</h2>
      <p>This admin is allowlisted. Please sign in with <span class="kbd">wykiesautomation@gmail.com</span>.</p>
    </section>
  </main>
  <footer>© Wykies Automation</footer>
  <script src="js/app.js"></script>
</body>
</html>